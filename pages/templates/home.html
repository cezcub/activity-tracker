{% extends 'base.html' %}

{% block content %}
<h1 style="font-size: 100px;" class="center">Only {{ date }} days left to go!</h1>

{% if not answered %}
<button style="background-color: lightblue;font-size: 40px;display: block;" onclick="openPopup()" class="center">Trivia question of the day!</button>
<br>
<div id="popup-1">
	<div class="popup-content">
		<h1>What is the sweetest and most romantic fruit?</h1>
		<h5>You only have <span id="counter">30</span> seconds left to answer!</h5>
		<form method="POST" id="myForm"> {% csrf_token %}
			{{ form.as_p }}
		<input type="submit" value="Enter"/>
		</form>
		<script type="text/javascript">
			function countdown(){
				var popup = document.getElementById("popup-1")
				var count = document.getElementById("counter")
				var form = document.getElementById("myForm")

				count.innerHTML = parseInt(count.innerHTML)-1;

				if (parseInt(count.innerHTML)<=0){
				popup.style.display="none";
				form.answer.value='None';
				form.submit();				
			}
		}
		</script>
		<script type="text/javascript">
			function openPopup(){
				var popup1 = document.getElementById("popup-1")
				popup1.style.display="block";
				window.setInterval(countdown, 1000);
			}
</script>
	</div>
</div>
{% else %}
	<h2 style="text-align: center;">You've already answered today's question! Come back tommorow for more!</h2>
{% endif %}
<ul>
	{% for key, value in participants.items %}
		<li><h3>{{ key.first_name }}</h3><a href = '/create_activity/{{ key.first_name }}'><button type="button">Create a new activity for {{ key.first_name }}</button></a><a href = '/delete_participant/{{ key.first_name }} '><button type="button" style="position:relative;left:10%;">Delete this participant</button></a>
		<br>
		<br>
			<table style="width: 50%">
				<tr>
					<th class="padded">Date</th>
					<th class="padded">Activity_Type</th>
					<th class="padded">Miles</th>
					<th class="padded">Time</th>
					<th class="padded">Edit</th>
					<th class="padded">Delete</th>
				</tr>
				{% for activity in value %}
						<tr>
							<td class="padded">{{ activity.date }}</td>
							<td class="padded">{{ activity.activity_type }}</td>
							<td class="padded">{{ activity.miles|floatformat }}</td>
							<td class="padded">{{ activity.time }}</td>
							<td class="padded"><a href="/edit_activity/{{ activity.pk }}"><button type="button">Edit</button></a></td>
							<td class="padded"><a href="/delete_activity/{{ activity.pk }}"><button type="button">Delete</button></a></td>
						</tr>
				{% endfor %}
			</table>
		</li>
	{% if value.has_previous %}
	<a href="?page={{ value.previous_page_number }}"><button>&lsaquo;</button></a>
	{% else %}
	<a href="?page=1"><button>&lsaquo;</button></a>
	{% endif %}
	{% for i in value.paginator.page_range %}
	<a href="?page={{ i }}"><button>{{ i }}</button></a>
	{% endfor %}
	{% if value.has_next %}
	<a href="?page={{ value.next_page_number }}"><button>&rsaquo;</button></a>
	{% else %}
	<a href="?page={{ current_page }}"><button>&rsaquo;</button></a>
	{% endif %}
{% endfor %}
</ul>
<a href = '/create_participant/'><button type="button">Create a new participant</button></a>
{% endblock %}